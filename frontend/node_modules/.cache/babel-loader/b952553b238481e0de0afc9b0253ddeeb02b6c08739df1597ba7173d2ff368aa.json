{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useState, useEffect, useRef, useCallback } from 'react';\nexport const useSSE = (url, options = {}) => {\n  _s();\n  const [data, setData] = useState(null);\n  const [error, setError] = useState(null);\n  const [isConnected, setIsConnected] = useState(false);\n  const eventSourceRef = useRef(null);\n  const dataRef = useRef({});\n  const optionsRef = useRef(options);\n\n  // Update options ref when options change\n  optionsRef.current = options;\n  const connect = useCallback(() => {\n    // Force close any existing connection\n    if (eventSourceRef.current) {\n      eventSourceRef.current.close();\n      eventSourceRef.current = null;\n    }\n    try {\n      const eventSource = new EventSource(url);\n      eventSourceRef.current = eventSource;\n      eventSource.onopen = () => {\n        setIsConnected(true);\n        setError(null);\n        if (optionsRef.current.onOpen) optionsRef.current.onOpen();\n      };\n      eventSource.onmessage = event => {\n        try {\n          const parsedData = JSON.parse(event.data);\n          if (optionsRef.current.onMessage) {\n            optionsRef.current.onMessage(parsedData);\n          }\n\n          // Handle different message types\n          switch (parsedData.type) {\n            case 'progress':\n              if (optionsRef.current.onProgress) {\n                optionsRef.current.onProgress(parsedData);\n              }\n              break;\n            case 'repository':\n              dataRef.current.repository = parsedData.data;\n              setData({\n                ...dataRef.current\n              });\n              break;\n            case 'contributors':\n              dataRef.current.contributors = parsedData.data;\n              setData({\n                ...dataRef.current\n              });\n              break;\n            case 'pull_requests':\n              dataRef.current.pull_requests = parsedData.data;\n              setData({\n                ...dataRef.current\n              });\n              break;\n            case 'commits_chunk':\n              if (!dataRef.current.commits) {\n                dataRef.current.commits = [];\n              }\n              dataRef.current.commits = dataRef.current.commits.concat(parsedData.data);\n              dataRef.current.total_commits = parsedData.total_so_far;\n              setData({\n                ...dataRef.current\n              });\n              break;\n            case 'detailed_commits_chunk':\n              if (!dataRef.current.detailed_commits) {\n                dataRef.current.detailed_commits = [];\n              }\n              dataRef.current.detailed_commits = dataRef.current.detailed_commits.concat(parsedData.data);\n              dataRef.current.total_detailed_commits = parsedData.total_so_far;\n              setData({\n                ...dataRef.current\n              });\n              break;\n            case 'analysis_complete':\n              dataRef.current.analysis = parsedData.data;\n              setData({\n                ...dataRef.current\n              });\n              if (optionsRef.current.onComplete) {\n                optionsRef.current.onComplete(parsedData.data);\n              }\n              break;\n            case 'error':\n              setError(parsedData.message);\n              if (optionsRef.current.onError) {\n                optionsRef.current.onError(parsedData.message);\n              }\n              break;\n            default:\n              break;\n          }\n        } catch (parseError) {\n          console.error('Failed to parse SSE data:', parseError);\n          setError('Failed to parse server response');\n        }\n      };\n      eventSource.onerror = event => {\n        setIsConnected(false);\n        setError('Connection error occurred');\n        if (optionsRef.current.onError) {\n          optionsRef.current.onError('Connection error occurred');\n        }\n      };\n    } catch (connectionError) {\n      setError('Failed to establish connection');\n      setIsConnected(false);\n    }\n  }, [url]);\n  const disconnect = useCallback(() => {\n    if (eventSourceRef.current) {\n      eventSourceRef.current.close();\n      eventSourceRef.current = null;\n      setIsConnected(false);\n    }\n  }, []);\n  const reset = useCallback(() => {\n    setData(null);\n    setError(null);\n    dataRef.current = {};\n  }, []);\n  useEffect(() => {\n    return () => {\n      disconnect();\n    };\n  }, [disconnect]);\n  return {\n    data,\n    error,\n    isConnected,\n    connect,\n    disconnect,\n    reset\n  };\n};\n_s(useSSE, \"+jDnfT7nLAU8ShRdZSpZd91HeH8=\");","map":{"version":3,"names":["useState","useEffect","useRef","useCallback","useSSE","url","options","_s","data","setData","error","setError","isConnected","setIsConnected","eventSourceRef","dataRef","optionsRef","current","connect","close","eventSource","EventSource","onopen","onOpen","onmessage","event","parsedData","JSON","parse","onMessage","type","onProgress","repository","contributors","pull_requests","commits","concat","total_commits","total_so_far","detailed_commits","total_detailed_commits","analysis","onComplete","message","onError","parseError","console","onerror","connectionError","disconnect","reset"],"sources":["/Users/ayush/Desktop/Projects/github-code-visualise/frontend/src/hooks/useSSE.js"],"sourcesContent":["import { useState, useEffect, useRef, useCallback } from 'react';\n\nexport const useSSE = (url, options = {}) => {\n  const [data, setData] = useState(null);\n  const [error, setError] = useState(null);\n  const [isConnected, setIsConnected] = useState(false);\n  const eventSourceRef = useRef(null);\n  const dataRef = useRef({});\n  const optionsRef = useRef(options);\n  \n  // Update options ref when options change\n  optionsRef.current = options;\n\n  const connect = useCallback(() => {\n    // Force close any existing connection\n    if (eventSourceRef.current) {\n      eventSourceRef.current.close();\n      eventSourceRef.current = null;\n    }\n\n    try {\n      const eventSource = new EventSource(url);\n      eventSourceRef.current = eventSource;\n\n      eventSource.onopen = () => {\n        setIsConnected(true);\n        setError(null);\n        if (optionsRef.current.onOpen) optionsRef.current.onOpen();\n      };\n\n      eventSource.onmessage = (event) => {\n        try {\n          const parsedData = JSON.parse(event.data);\n          \n          if (optionsRef.current.onMessage) {\n            optionsRef.current.onMessage(parsedData);\n          }\n\n          // Handle different message types\n          switch (parsedData.type) {\n            case 'progress':\n              if (optionsRef.current.onProgress) {\n                optionsRef.current.onProgress(parsedData);\n              }\n              break;\n              \n            case 'repository':\n              dataRef.current.repository = parsedData.data;\n              setData({ ...dataRef.current });\n              break;\n              \n            case 'contributors':\n              dataRef.current.contributors = parsedData.data;\n              setData({ ...dataRef.current });\n              break;\n              \n            case 'pull_requests':\n              dataRef.current.pull_requests = parsedData.data;\n              setData({ ...dataRef.current });\n              break;\n              \n            case 'commits_chunk':\n              if (!dataRef.current.commits) {\n                dataRef.current.commits = [];\n              }\n              dataRef.current.commits = dataRef.current.commits.concat(parsedData.data);\n              dataRef.current.total_commits = parsedData.total_so_far;\n              setData({ ...dataRef.current });\n              break;\n              \n            case 'detailed_commits_chunk':\n              if (!dataRef.current.detailed_commits) {\n                dataRef.current.detailed_commits = [];\n              }\n              dataRef.current.detailed_commits = dataRef.current.detailed_commits.concat(parsedData.data);\n              dataRef.current.total_detailed_commits = parsedData.total_so_far;\n              setData({ ...dataRef.current });\n              break;\n              \n            case 'analysis_complete':\n              dataRef.current.analysis = parsedData.data;\n              setData({ ...dataRef.current });\n              if (optionsRef.current.onComplete) {\n                optionsRef.current.onComplete(parsedData.data);\n              }\n              break;\n              \n            case 'error':\n              setError(parsedData.message);\n              if (optionsRef.current.onError) {\n                optionsRef.current.onError(parsedData.message);\n              }\n              break;\n              \n            default:\n              break;\n          }\n        } catch (parseError) {\n          console.error('Failed to parse SSE data:', parseError);\n          setError('Failed to parse server response');\n        }\n      };\n\n      eventSource.onerror = (event) => {\n        setIsConnected(false);\n        setError('Connection error occurred');\n        if (optionsRef.current.onError) {\n          optionsRef.current.onError('Connection error occurred');\n        }\n      };\n\n    } catch (connectionError) {\n      setError('Failed to establish connection');\n      setIsConnected(false);\n    }\n  }, [url]);\n\n  const disconnect = useCallback(() => {\n    if (eventSourceRef.current) {\n      eventSourceRef.current.close();\n      eventSourceRef.current = null;\n      setIsConnected(false);\n    }\n  }, []);\n\n  const reset = useCallback(() => {\n    setData(null);\n    setError(null);\n    dataRef.current = {};\n  }, []);\n\n  useEffect(() => {\n    return () => {\n      disconnect();\n    };\n  }, [disconnect]);\n\n  return {\n    data,\n    error,\n    isConnected,\n    connect,\n    disconnect,\n    reset\n  };\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}